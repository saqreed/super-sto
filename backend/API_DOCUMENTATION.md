# üöó –°—É–ø–µ—Ä–°–¢–û - API –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

## üìù –û–±–∑–æ—Ä

–°—É–ø–µ—Ä–°–¢–û API - —ç—Ç–æ RESTful –≤–µ–±-—Å–µ—Ä–≤–∏—Å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–æ–º —Å –ø–æ–ª–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å—é:
- –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
- –°–∏—Å—Ç–µ–º–∞ –∑–∞–ø–∏—Å–µ–π –∏ –∑–∞–∫–∞–∑–æ–≤
- –ß–∞—Ç –∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ –æ—Ç—á–µ—Ç—ã
- –ü—Ä–æ–≥—Ä–∞–º–º–∞ –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏

**–ë–∞–∑–æ–≤—ã–π URL**: `http://localhost:8080/api`

## üîê –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

–°–∏—Å—Ç–µ–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç JWT —Ç–æ–∫–µ–Ω—ã –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏.

### –ó–∞–≥–æ–ª–æ–≤–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤
```
Authorization: Bearer <JWT_TOKEN>
Content-Type: application/json
```

### –†–æ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- **CLIENT** - –ö–ª–∏–µ–Ω—Ç –∞–≤—Ç–æ—Å–µ—Ä–≤–∏—Å–∞
- **MASTER** - –ú–∞—Å—Ç–µ—Ä/–º–µ—Ö–∞–Ω–∏–∫
- **ADMIN** - –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä

---

## üìã Endpoints

### üîë –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
#### POST `/auth/register`
–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**–ó–∞–ø—Ä–æ—Å:**
```json
{
  "email": "user@example.com",
  "password": "password123",
  "firstName": "–ò–º—è",
  "lastName": "–§–∞–º–∏–ª–∏—è",
  "phone": "+7-900-123-45-67",
  "role": "CLIENT"
}
```

**–û—Ç–≤–µ—Ç 201:**
```json
{
  "accessToken": "eyJhbGciOiJIUzI1NiJ9...",
  "refreshToken": "eyJhbGciOiJIUzI1NiJ9...",
  "tokenType": "Bearer",
  "expiresIn": 86400
}
```

#### POST `/auth/login`
–í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É

**–ó–∞–ø—Ä–æ—Å:**
```json
{
  "email": "user@example.com",
  "password": "password123"
}
```

#### POST `/auth/refresh`
–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞

**–ó–∞–ø—Ä–æ—Å:**
```json
{
  "refreshToken": "eyJhbGciOiJIUzI1NiJ9..."
}
```

---

### üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
#### GET `/users/profile`
–ü–æ–ª—É—á–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**–û—Ç–≤–µ—Ç 200:**
```json
{
  "id": "user-id",
  "email": "user@example.com",
  "firstName": "–ò–º—è",
  "lastName": "–§–∞–º–∏–ª–∏—è",
  "phone": "+7-900-123-45-67",
  "role": "CLIENT",
  "loyaltyLevel": "BRONZE",
  "loyaltyPoints": 150,
  "isActive": true,
  "createdAt": "2024-01-15T10:30:00"
}
```

#### PUT `/users/profile`
–û–±–Ω–æ–≤–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å

**–ó–∞–ø—Ä–æ—Å:**
```json
{
  "firstName": "–ù–æ–≤–æ–µ –∏–º—è",
  "lastName": "–ù–æ–≤–∞—è —Ñ–∞–º–∏–ª–∏—è",
  "phone": "+7-900-000-00-00"
}
```

---

### üõ† –£—Å–ª—É–≥–∏
#### GET `/services`
–ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∞–∫—Ç–∏–≤–Ω—ã—Ö —É—Å–ª—É–≥

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞:**
- `category` (optional) - –ö–∞—Ç–µ–≥–æ—Ä–∏—è —É—Å–ª—É–≥–∏
- `search` (optional) - –ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é

**–û—Ç–≤–µ—Ç 200:**
```json
[
  {
    "id": "service-id",
    "name": "–ó–∞–º–µ–Ω–∞ –º–∞—Å–ª–∞",
    "description": "–ü–æ–ª–Ω–∞—è –∑–∞–º–µ–Ω–∞ –º–æ—Ç–æ—Ä–Ω–æ–≥–æ –º–∞—Å–ª–∞",
    "category": "MAINTENANCE",
    "price": 2500.00,
    "duration": 30,
    "isActive": true,
    "rating": 4.5,
    "reviewCount": 25
  }
]
```

#### POST `/services` [ADMIN]
–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é —É—Å–ª—É–≥—É

---

### üìÖ –ó–∞–ø–∏—Å–∏
#### GET `/appointments/my`
–ü–æ–ª—É—á–∏—Ç—å –∑–∞–ø–∏—Å–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

#### POST `/appointments`
–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å

**–ó–∞–ø—Ä–æ—Å:**
```json
{
  "serviceId": "service-id",
  "masterId": "master-id",
  "appointmentDateTime": "2024-01-20T14:00:00",
  "notes": "–û—Å–æ–±—ã–µ –ø–æ–∂–µ–ª–∞–Ω–∏—è"
}
```

#### PUT `/appointments/{id}/status`
–ò–∑–º–µ–Ω–∏—Ç—å —Å—Ç–∞—Ç—É—Å –∑–∞–ø–∏—Å–∏

**–ó–∞–ø—Ä–æ—Å:**
```json
{
  "status": "CONFIRMED"
}
```

**–°—Ç–∞—Ç—É—Å—ã –∑–∞–ø–∏—Å–µ–π:**
- `PENDING` - –û–∂–∏–¥–∞–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
- `CONFIRMED` - –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞
- `IN_PROGRESS` - –í –ø—Ä–æ—Ü–µ—Å—Å–µ
- `COMPLETED` - –ó–∞–≤–µ—Ä—à–µ–Ω–∞
- `CANCELLED` - –û—Ç–º–µ–Ω–µ–Ω–∞

---

### üõí –ü—Ä–æ–¥—É–∫—Ç—ã –∏ –∑–∞–∫–∞–∑—ã
#### GET `/products`
–ü–æ–ª—É—á–∏—Ç—å –∫–∞—Ç–∞–ª–æ–≥ –ø—Ä–æ–¥—É–∫—Ç–æ–≤

#### POST `/orders`
–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –∑–∞–∫–∞–∑

**–ó–∞–ø—Ä–æ—Å:**
```json
{
  "items": [
    {
      "productId": "product-id",
      "quantity": 2
    }
  ],
  "deliveryAddress": "–ê–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏"
}
```

---

### ‚≠ê –û—Ç–∑—ã–≤—ã
#### GET `/reviews`
–ü–æ–ª—É—á–∏—Ç—å –æ—Ç–∑—ã–≤—ã

#### POST `/reviews`
–°–æ–∑–¥–∞—Ç—å –æ—Ç–∑—ã–≤

**–ó–∞–ø—Ä–æ—Å:**
```json
{
  "serviceId": "service-id",
  "masterId": "master-id",
  "appointmentId": "appointment-id",
  "rating": 5,
  "comment": "–û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞!"
}
```

---

### üí¨ –ß–∞—Ç
#### POST `/chat/send`
–û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ

**–ó–∞–ø—Ä–æ—Å:**
```json
{
  "recipientId": "user-id",
  "content": "–¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è",
  "type": "TEXT",
  "appointmentId": "appointment-id"
}
```

#### GET `/chat/conversation/{userId}`
–ü–æ–ª—É—á–∏—Ç—å –ø–µ—Ä–µ–ø–∏—Å–∫—É —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º

#### GET `/chat/unread/count`
–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π

---

### üîî –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
#### GET `/notifications/my`
–ü–æ–ª—É—á–∏—Ç—å –º–æ–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

#### GET `/notifications/unread`
–ù–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

#### PUT `/notifications/{id}/read`
–û—Ç–º–µ—Ç–∏—Ç—å –∫–∞–∫ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω–æ–µ

---

### üìä –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ [ADMIN]
#### GET `/analytics/dashboard`
–û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –¥–∞—à–±–æ—Ä–¥–∞

**–û—Ç–≤–µ—Ç 200:**
```json
{
  "totalClients": 150,
  "totalMasters": 8,
  "todayAppointments": 12,
  "monthRevenue": 450000.00,
  "monthGrowth": 15.5,
  "pendingOrders": 5,
  "lowStockItems": 3,
  "averageRating": 4.7,
  "topServices": [...],
  "topMasters": [...]
}
```

#### GET `/analytics/revenue`
–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –¥–æ—Ö–æ–¥–æ–≤

#### GET `/analytics/masters/top`
–¢–æ–ø –º–∞—Å—Ç–µ—Ä–∞ –ø–æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

---

### üìà –û—Ç—á–µ—Ç—ã [ADMIN]
#### GET `/reports/appointments`
–û—Ç—á–µ—Ç –ø–æ –∑–∞–ø–∏—Å—è–º –∑–∞ –ø–µ—Ä–∏–æ–¥

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `startDate` - –î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞ (ISO 8601)
- `endDate` - –î–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è (ISO 8601)
- `status` (optional) - –°—Ç–∞—Ç—É—Å –∑–∞–ø–∏—Å–µ–π

#### GET `/reports/orders`
–û—Ç—á–µ—Ç –ø–æ –∑–∞–∫–∞–∑–∞–º

---

## üö® –ö–æ–¥—ã –æ—à–∏–±–æ–∫

### HTTP –°—Ç–∞—Ç—É—Å—ã
- `200` - –£—Å–ø–µ—à–Ω–æ
- `201` - –°–æ–∑–¥–∞–Ω–æ
- `400` - –ù–µ–≤–µ—Ä–Ω—ã–π –∑–∞–ø—Ä–æ—Å
- `401` - –ù–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω
- `403` - –î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω
- `404` - –ù–µ –Ω–∞–π–¥–µ–Ω–æ
- `409` - –ö–æ–Ω—Ñ–ª–∏–∫—Ç
- `500` - –í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞

### –§–æ—Ä–º–∞—Ç –æ—à–∏–±–æ–∫
```json
{
  "timestamp": "2024-01-15T10:30:00",
  "status": 400,
  "error": "Bad Request",
  "message": "–û–ø–∏—Å–∞–Ω–∏–µ –æ—à–∏–±–∫–∏",
  "path": "/api/endpoint"
}
```

### –¢–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏
- `USER_NOT_FOUND` - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω
- `INVALID_CREDENTIALS` - –ù–µ–≤–µ—Ä–Ω—ã–µ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- `ACCESS_DENIED` - –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–∞–≤
- `VALIDATION_ERROR` - –û—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
- `BUSINESS_RULE_VIOLATION` - –ù–∞—Ä—É—à–µ–Ω–∏–µ –±–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª

---

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
```bash
# –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
MONGO_URI=mongodb://localhost:27017/supersto_db

# JWT
JWT_SECRET=your-secret-key
JWT_EXPIRATION=86400

# CORS
CORS_ALLOWED_ORIGINS=http://localhost:3000

# –ü—Ä–æ—Ñ–∏–ª—å
SPRING_PROFILES_ACTIVE=dev
```

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤
```bash
./mvnw test
```

### –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤ (cURL)

#### –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
```bash
curl -X POST http://localhost:8080/api/auth/register \
  -H "Content-Type: application/json" \
  -d '{
    "email": "test@example.com",
    "password": "password123",
    "firstName": "–¢–µ—Å—Ç",
    "lastName": "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å",
    "role": "CLIENT"
  }'
```

#### –ü–æ–ª—É—á–µ–Ω–∏–µ —É—Å–ª—É–≥
```bash
curl -X GET http://localhost:8080/api/services \
  -H "Authorization: Bearer YOUR_TOKEN"
```

---

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

### Swagger UI
–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –¥–æ—Å—Ç—É–ø–Ω–∞ –ø–æ –∞–¥—Ä–µ—Å—É: `http://localhost:8080/swagger-ui.html`

### Monitoring
- Health Check: `GET /actuator/health`
- Metrics: `GET /actuator/metrics`

### –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
API –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–µ –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ. –¢–µ–∫—É—â–∞—è –≤–µ—Ä—Å–∏—è: `v1.0.0`

---

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ**: 2024-01-XX  
**–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫**: –°—É–ø–µ—Ä–°–¢–û Team  
**–ü–æ–¥–¥–µ—Ä–∂–∫–∞**: support@supersto.ru 